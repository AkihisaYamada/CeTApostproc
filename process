#!/bin/bash

result=`sed 1q "$1"`
sed -n '1!p' "$1" > "$prooffile"

if [ "$result" = "YES" ]; then
	claim='<terminating/>'
elif [ "$result" = "NO" ]; then
	claim='<nonterminating/>'
else
	claim=
fi

if [ "$claim" != "" -a -f "$2/cpf.xml" ]; then
	prooffile=`mktemp`
	claimfile=`mktemp`
	certtimefile=`mktemp`
	echo $claim > "$claimfile"
	certout=`/usr/bin/time --quiet -o "$certtimefile" -f %U ./ceta "$2" "$claimfile" "$prooffile" 2> /dev/null`
	certtime=`cat $certtimefile`
fi

echo starexec-result=$result
echo result=$result
echo certification-result=$certout
echo certification-time=$certtime

rm "$prooffile" "$claimfile" "$certimefile"